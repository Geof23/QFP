#CC := clang++
CC := g++
FFLAGS ?=
TARGET ?= test

CPPFLAGS ?= -Wuninitialized -g #-fsanitize=thread

CPPFLAGS += $(FFLAGS)
CPPFLAGS += -std=c++14
CPPFLAGS += -Wno-shift-count-overflow
CPPFLAGS += -MMD
CPPFLAGS += -lm
CPPFLAGS += -lpthread
CPPFLAGS += -pthread
CPPFLAGS += -I../gdb/inst
CPPFLAGS += -I.
CPPFLAGS += -isystem eigen
CPPFLAGS += -isystem eigen/Eigen

INCFILES := $(wildcard *.h)
INCFILES += $(wildcard eigen/*.h)
INCFILES += $(wildcard eigen/Eigen/*)

SOURCE := $(wildcard *.cpp)
OBJ := $(SOURCE:.cpp=.o)

.phony : all

all :  $(TARGET)

$(TARGET) : $(OBJ)
	$(CC) $(CPPFLAGS)   -o $@ $^

%.o : %.cpp $(INCFILES)
	$(CC) $(CPPFLAGS) -c $< -o $@

.phony : clean

clean :
	rm -f *.o test *.d
