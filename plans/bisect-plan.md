# FLiT Bisect Plan

The user adds custom build specifications to `custom.mk`.  This file should be
leveraged in the autogenerated Makefiles, as well as the customization in the
`flit-config.toml` file.

Here are the following design choices for accomplishing such a task:

1. compile using Python and skip Makefiles altogether
    - Too much work and not enough benefit.  Also unmaintainable
2. Generate a new `Makefile` similar to the already generated `Makefile`.  This
   could either be within the current directory or within `/tmp`.
3. Change the original generated `Makefile` to include an arbitrary `.mk` file
   based on a variable that is assigned in the call to `make`.
    - This approach seems more reasonable since the recursive `Makefile` change
      has been delivered, because we do not have any overhead until we are
      compiling a particular mode.

## Generate Source Files

The sources we need to compile will either be located in the autogenerated
`Makefile` (using the `$(wildcard)` GNU make function), or in `custom.mk`.  We
want the user to be able to specify additional source files in `custom.mk`, so
therefore, we need to query the `Makefile` for the list of source files.

There is a cool hack from [eric melski's blog](https://blog.melski.net/2010/11/30/makefile-hacks-print-the-value-of-any-variable/):

```make
print-%:
	@echo '$*=$($*)'
```

or the expanded version:

```make
print-%:
	@echo '$*=$($*)'
	@echo '  origin = $(origin $*)'
	@echo '  flavor = $(flavor $*)'
	@echo '   value = $(value $*)'
```

These rules can actually be placed in another `Makefile` and included separately

```bash
$ make -f printvar.mk -f Makefile print-SOURCE
```
