# This is to cleanup minor inconsistencies in data.  We should probably
# do this upstream, but this is OK for now

Create OR REPLACE FUNCTION cleanupResults(run integer default -1) RETURNS integer as $$
if run == -1:
    r = ("SELECT MAX(index)as index from runs;")
    res = plpy.execute(r)
    run = res[0]["index"]
    
s = ("update tests set compiler = 'icpc' where compiler ~ " +
     "'.*icpc.*' and run = " + run)   
res = plpy.execute(s)
   return res.nrows()
$$ LANGUAGE plpython3u;

