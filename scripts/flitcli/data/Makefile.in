# Autogenerated Makefile using "flit update"

CC             := {compiler}
FFLAGS         ?=
TARGET         ?= runTests

# TODO: replace these paths from flitconfig.py
FLIT_INC_DIR   := {flit_include_dir}
FLIT_LIB_DIR   := {flit_lib_dir}
FLIT_SCRIPT    := {flit_script}

CC_REQUIRED    += $(FFLAGS)
CC_REQUIRED    += -Wuninitialized -g
CC_REQUIRED    += -std=c++11
CC_REQUIRED    += -Wno-shift-count-overflow
CC_REQUIRED    += -Wall
CC_REQUIRED    += -Wextra
CC_REQUIRED    += -I.
CC_REQUIRED    += -DWFT=float -DSCH_LIB
CC_REQUIRED    += -I$(FLIT_INC_DIR)

LD_REQUIRED    += -lm
LD_REQUIRED    += -L$(FLIT_LIB_DIR) -lflit
LD_REQUIRED    += -Wl,-rpath=$(realpath $(FLIT_LIB_DIR))

DEPFLAGS       += -MD -MF $*.d

TESTS          := $(wildcard tests/*.cpp)
SOURCE         := $(wildcard *.cpp)
SOURCE         += $(TESTS)

OBJ            := $(SOURCE:.cpp=.o)
DEPS           := $(SOURCE:.cpp=.d)


.PHONY : all
all :  $(TARGET)

$(TARGET) : $(OBJ) Makefile
	$(CC) $(CC_REQUIRED) -o $@ $(OBJ) $(LD_REQUIRED)

%.o : %.cpp Makefile
	$(CC) $(CC_REQUIRED) $(DEPFLAGS) -c $< -o $@

.PRECIOUS: %.d
-include $(SOURCE:%.cpp=%.d)

.PHONY : clean
clean :
	rm -f $(OBJ)
	rm -f $(DEPS)

.PHONY: veryclean distclean
veryclean : distclean
distclean : clean
	rm -f $(TARGET)

-include custom.mk
